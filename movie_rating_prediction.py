# -*- coding: utf-8 -*-
"""movie rating prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13iTfg2iAJ3LEuaKsGvqSJkK4xdfSZH6J
"""

import pandas as pd       #loading the libraries
import numpy as np
from  sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

columns=['user_id', 'item_id', 'rating','timestamp']
data=pd.read_csv('u.data',sep='\t',names=columns)    #uploading the dataset
print(data.head())

x=data[['user_id','item_id']]         #defining the independent variable
y=data['rating']                      #defining the dependent variable
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)    #splitting train and test set

model=LinearRegression()          #traing the model
model.fit(x_train,y_train)

y_pred=model.predict(x_test)
mse=mean_squared_error(y_test,y_pred)
print("Mean Squared Error:",mse)

sample=np.array([[50,100]])
print("Predicted rating ", model.predict(sample))